diff --git a/tests/backends/test_xgrammar.py b/tests/backends/test_xgrammar.py
index 1133b9f0..5bd5647b 100644
--- a/tests/backends/test_xgrammar.py
+++ b/tests/backends/test_xgrammar.py
@@ -1,4 +1,6 @@
 import pytest
+import time
+from unittest.mock import patch, MagicMock
 
 import llama_cpp
 import transformers
@@ -93,3 +95,221 @@ def test_xgrammar_backend_invalid_model(model_llamacpp):
         match="The xgrammar backend only supports Transformers models",
     ):
         XGrammarBackend(model_llamacpp)
+
+
+def test_xgrammar_backend_caching_disabled_by_default(model_transformers, json_schema):
+    """Test that caching is disabled by default and works correctly."""
+    backend = XGrammarBackend(model_transformers)  # Default should be cache_compiled_grammars=False
+
+    # Should work fine without caching
+    processor1 = backend.get_json_schema_logits_processor(json_schema)
+    processor2 = backend.get_json_schema_logits_processor(json_schema)
+
+    # Both processors should work correctly (testing that feature works regardless of caching)
+    assert isinstance(processor1, XGrammarLogitsProcessor)
+    assert isinstance(processor2, XGrammarLogitsProcessor)
+ 
+    # Test that processors are functional (implementation-agnostic)
+    assert hasattr(processor1, 'process_logits')
+    assert hasattr(processor2, 'process_logits')
+
+
+def test_xgrammar_backend_caching_enabled(model_transformers, json_schema):
+    """Test that caching can be enabled and works correctly."""
+    backend = XGrammarBackend(model_transformers, cache_compiled_grammars=True)
+
+    # Should work fine with caching enabled
+    processor1 = backend.get_json_schema_logits_processor(json_schema)
+    processor2 = backend.get_json_schema_logits_processor(json_schema)
+
+    # Results should be functionally equivalent (focus on behavior, not object identity)
+    assert processor1.compiled_grammar == processor2.compiled_grammar
+ 
+    # Test that both processors work correctly with the same grammar
+    assert isinstance(processor1, XGrammarLogitsProcessor)
+    assert isinstance(processor2, XGrammarLogitsProcessor)
+
+
+def test_grammar_caching_json_schema(model_transformers, json_schema):
+    """Test caching works for JSON schema compilation."""
+    backend = XGrammarBackend(model_transformers, cache_compiled_grammars=True)
+
+    # First compilation
+    processor1 = backend.get_json_schema_logits_processor(json_schema)
+
+    # Second compilation should use cached result
+    processor2 = backend.get_json_schema_logits_processor(json_schema)
+
+    # Both processors should have functionally equivalent compiled grammars
+    assert processor1.compiled_grammar == processor2.compiled_grammar
+ 
+    # Test that both processors work correctly
+    assert isinstance(processor1, XGrammarLogitsProcessor)
+    assert isinstance(processor2, XGrammarLogitsProcessor)
+
+
+def test_grammar_caching_regex(model_transformers, regex):
+    """Test caching works for regex compilation."""
+    backend = XGrammarBackend(model_transformers, cache_compiled_grammars=True)
+
+    # First compilation
+    processor1 = backend.get_regex_logits_processor(regex)
+
+    # Second compilation should use cached result
+    processor2 = backend.get_regex_logits_processor(regex)
+
+    # Both processors should have functionally equivalent compiled grammars
+    assert processor1.compiled_grammar == processor2.compiled_grammar
+ 
+    # Test that both processors work correctly
+    assert isinstance(processor1, XGrammarLogitsProcessor)
+    assert isinstance(processor2, XGrammarLogitsProcessor)
+
+
+def test_grammar_caching_cfg(model_transformers, cfg):
+    """Test caching works for CFG compilation."""
+    backend = XGrammarBackend(model_transformers, cache_compiled_grammars=True)
+
+    # First compilation
+    processor1 = backend.get_cfg_logits_processor(cfg)
+
+    # Second compilation should use cached result
+    processor2 = backend.get_cfg_logits_processor(cfg)
+
+    # Both processors should have functionally equivalent compiled grammars
+    assert processor1.compiled_grammar == processor2.compiled_grammar
+ 
+    # Test that both processors work correctly
+    assert isinstance(processor1, XGrammarLogitsProcessor)
+    assert isinstance(processor2, XGrammarLogitsProcessor)
+
+
+def test_grammar_caching_different_grammars(model_transformers, json_schema, regex, cfg):
+    """Test that different grammars are cached separately."""
+    backend = XGrammarBackend(model_transformers, cache_compiled_grammars=True)
+
+    # Compile different grammar types
+    json_processor = backend.get_json_schema_logits_processor(json_schema)
+    regex_processor = backend.get_regex_logits_processor(regex)
+    cfg_processor = backend.get_cfg_logits_processor(cfg)
+
+    # All compiled grammars should be different
+    assert json_processor.compiled_grammar != regex_processor.compiled_grammar
+    assert json_processor.compiled_grammar != cfg_processor.compiled_grammar
+    assert regex_processor.compiled_grammar != cfg_processor.compiled_grammar
+
+    # Test that each grammar type caches correctly by checking functional equivalence
+    json_processor2 = backend.get_json_schema_logits_processor(json_schema)
+    regex_processor2 = backend.get_regex_logits_processor(regex)
+    cfg_processor2 = backend.get_cfg_logits_processor(cfg)
+
+    # Same grammar types should return functionally equivalent results
+    assert json_processor.compiled_grammar == json_processor2.compiled_grammar
+    assert regex_processor.compiled_grammar == regex_processor2.compiled_grammar
+    assert cfg_processor.compiled_grammar == cfg_processor2.compiled_grammar
+ 
+    # Verify all processors work correctly
+    assert isinstance(json_processor, XGrammarLogitsProcessor)
+    assert isinstance(json_processor2, XGrammarLogitsProcessor)
+    assert isinstance(regex_processor, XGrammarLogitsProcessor)
+    assert isinstance(regex_processor2, XGrammarLogitsProcessor)
+    assert isinstance(cfg_processor, XGrammarLogitsProcessor)
+    assert isinstance(cfg_processor2, XGrammarLogitsProcessor)
+
+
+def test_grammar_caching_disabled_no_cache(model_transformers, json_schema):
+    """Test that no caching occurs when disabled."""
+    backend = XGrammarBackend(model_transformers, cache_compiled_grammars=False)
+
+    # Multiple compilations should work fine but not cache
+    processor1 = backend.get_json_schema_logits_processor(json_schema)
+    processor2 = backend.get_json_schema_logits_processor(json_schema)
+    processor3 = backend.get_json_schema_logits_processor(json_schema)
+
+    # All processors should work correctly (focus on behavior, not internal state)
+    assert isinstance(processor1, XGrammarLogitsProcessor)
+    assert isinstance(processor2, XGrammarLogitsProcessor)
+    assert isinstance(processor3, XGrammarLogitsProcessor)
+ 
+    # Verify processors are functional
+    assert hasattr(processor1, 'process_logits')
+    assert hasattr(processor2, 'process_logits')
+    assert hasattr(processor3, 'process_logits')
+
+
+@pytest.mark.skip(reason="Performance tests can be flaky and implementation-dependent")
+def test_grammar_caching_performance_improvement(model_transformers, json_schema):
+    """Test that caching may improve performance (optional test, can be implementation-dependent)."""
+    backend_no_cache = XGrammarBackend(model_transformers, cache_compiled_grammars=False)
+    backend_with_cache = XGrammarBackend(model_transformers, cache_compiled_grammars=True)
+
+    # Test that both backends work correctly regardless of performance characteristics
+    processor_no_cache = backend_no_cache.get_json_schema_logits_processor(json_schema)
+    processor_with_cache = backend_with_cache.get_json_schema_logits_processor(json_schema)
+ 
+    # Verify both produce functionally equivalent results
+    assert processor_no_cache.compiled_grammar == processor_with_cache.compiled_grammar
+    assert isinstance(processor_no_cache, XGrammarLogitsProcessor)
+    assert isinstance(processor_with_cache, XGrammarLogitsProcessor)
+ 
+    # Note: Performance characteristics may vary by implementation
+    # This test focuses on functional correctness rather than timing
+
+
+def test_grammar_caching_thread_safety(model_transformers, json_schema):
+    """Test that caching works correctly in concurrent scenarios."""
+    backend = XGrammarBackend(model_transformers, cache_compiled_grammars=True)
+
+    # Test basic concurrent-like operations
+    processor1 = backend.get_json_schema_logits_processor(json_schema)
+    processor2 = backend.get_json_schema_logits_processor(json_schema)
+
+    # Both should have functionally equivalent cached results
+    assert processor1.compiled_grammar == processor2.compiled_grammar
+ 
+    # Verify both processors work correctly
+    assert isinstance(processor1, XGrammarLogitsProcessor)
+    assert isinstance(processor2, XGrammarLogitsProcessor)
+
+
+def test_grammar_caching_edge_cases(model_transformers):
+    """Test edge cases for grammar caching."""
+    backend = XGrammarBackend(model_transformers, cache_compiled_grammars=True)
+
+    # Simple single character regex
+    processor1 = backend.get_regex_logits_processor("a")
+    processor2 = backend.get_regex_logits_processor("a")
+    assert processor1.compiled_grammar == processor2.compiled_grammar
+ 
+    # Very long string
+    long_regex = "a" * 100
+    processor3 = backend.get_regex_logits_processor(long_regex)
+    processor4 = backend.get_regex_logits_processor(long_regex)
+    assert processor3.compiled_grammar == processor4.compiled_grammar
+
+    # Different grammars should not interfere
+    assert processor1.compiled_grammar != processor3.compiled_grammar
+ 
+    # Verify all processors work correctly
+    assert isinstance(processor1, XGrammarLogitsProcessor)
+    assert isinstance(processor2, XGrammarLogitsProcessor)
+    assert isinstance(processor3, XGrammarLogitsProcessor)
+    assert isinstance(processor4, XGrammarLogitsProcessor)
+
+
+def test_grammar_caching_backward_compatibility(model_transformers, json_schema):
+    """Test that existing code works without modification."""
+    # This is how existing code would call it (without cache parameter)
+    backend = XGrammarBackend(model_transformers)
+
+    # Should work exactly as before
+    processor = backend.get_json_schema_logits_processor(json_schema)
+    assert isinstance(processor, XGrammarLogitsProcessor)
+
+    # Multiple calls should work fine
+    processor2 = backend.get_json_schema_logits_processor(json_schema)
+    assert isinstance(processor2, XGrammarLogitsProcessor)
+ 
+    # Verify processors are functional (implementation-agnostic)
+    assert hasattr(processor, 'process_logits')
+    assert hasattr(processor2, 'process_logits')
