diff --git a/outlines/backends/xgrammar.py b/outlines/backends/xgrammar.py
index fcb1672d..96762b8a 100644
--- a/outlines/backends/xgrammar.py
+++ b/outlines/backends/xgrammar.py
@@ -1,6 +1,6 @@
 """Backend class for XGrammar."""

-from typing import TYPE_CHECKING
+from typing import TYPE_CHECKING, Optional

 from outlines.backends.base import BaseBackend
 from outlines.models import SteerableModel
@@ -9,6 +9,7 @@ from outlines.processors.base_logits_processor import (
     OutlinesLogitsProcessor,
     TensorType
 )
+from outlines.processors.tensor_adapters.base import TensorAdapter

 if TYPE_CHECKING:
     from xgrammar.contrib.hf import LogitsProcessor
@@ -22,20 +23,48 @@ class XGrammarLogitsProcessor(OutlinesLogitsProcessor):

     """

-    def __init__(self, compiled_grammar: str):
+    def __init__(
+        self,
+        compiled_grammar: str,
+        tensor_library_name: str = "torch",
+        custom_adapter: Optional[TensorAdapter] = None
+    ):
         """
         Parameters
         ----------
         compiled_grammar: str
             The compiled grammar to use to create the logits processor.
+        tensor_library_name: str
+            The name of the tensor library to use. Can be "torch", "mlx",
+            "numpy", "jax", "tensorflow", or "custom".
+        custom_adapter: Optional[TensorAdapter]
+            Custom tensor adapter to use when tensor_library_name is "custom".
+            Must implement the TensorAdapter interface.

         """
         import xgrammar as xgr

+        if tensor_library_name == "custom" and custom_adapter is None:
+            raise ValueError(
+                "custom_adapter must be provided when tensor_library_name is 'custom'"
+            )
+
+        if tensor_library_name != "custom" and custom_adapter is not None:
+            raise ValueError(
+                "custom_adapter should only be provided when tensor_library_name is 'custom'"
+            )
+
         self.xgr = xgr
         self.compiled_grammar = compiled_grammar
         self.xgrammar_logits_processor = None
-        super().__init__("torch")
+        self.custom_adapter = custom_adapter
+
+        # Initialize the parent class with the tensor library
+        super().__init__(tensor_library_name)
+
+        # Override tensor_adapter if custom adapter is provided
+        if custom_adapter is not None:
+            self.tensor_adapter = custom_adapter

     def reset(self):
         """Reset the logits processor for a new generation."""
@@ -79,7 +108,10 @@ class XGrammarBackend(BaseBackend):
         self.grammar_compiler = xgr.GrammarCompiler(tokenizer_info)

     def get_json_schema_logits_processor(
-        self, json_schema: str
+        self,
+        json_schema: str,
+        tensor_library_name: str = "torch",
+        custom_adapter: Optional[TensorAdapter] = None
     ) -> "LogitsProcessor":
         """Create a logits processor from a JSON schema.

@@ -87,6 +119,11 @@ class XGrammarBackend(BaseBackend):
         ----------
         json_schema: str
             The JSON schema to create a logits processor from.
+        tensor_library_name: str
+            The name of the tensor library to use. Can be "torch", "mlx",
+            "numpy", "jax", "tensorflow", or "custom".
+        custom_adapter: Optional[TensorAdapter]
+            Custom tensor adapter to use when tensor_library_name is "custom".

         Returns
         -------
@@ -97,15 +134,27 @@ class XGrammarBackend(BaseBackend):
         compiled_grammar = self.grammar_compiler.compile_json_schema(
             json_schema
         )
-        return XGrammarLogitsProcessor(compiled_grammar)
+        return XGrammarLogitsProcessor(
+            compiled_grammar, tensor_library_name, custom_adapter
+        )

-    def get_regex_logits_processor(self, regex: str) -> "LogitsProcessor":
+    def get_regex_logits_processor(
+        self,
+        regex: str,
+        tensor_library_name: str = "torch",
+        custom_adapter: Optional[TensorAdapter] = None
+    ) -> "LogitsProcessor":
         """Create a logits processor from a regex.

         Parameters
         ----------
         regex: str
             The regex to create a logits processor from.
+        tensor_library_name: str
+            The name of the tensor library to use. Can be "torch", "mlx",
+            "numpy", "jax", "tensorflow", or "custom".
+        custom_adapter: Optional[TensorAdapter]
+            Custom tensor adapter to use when tensor_library_name is "custom".

         Returns
         -------
@@ -114,15 +163,27 @@ class XGrammarBackend(BaseBackend):

         """
         compiled_grammar = self.grammar_compiler.compile_regex(regex)
-        return XGrammarLogitsProcessor(compiled_grammar)
+        return XGrammarLogitsProcessor(
+            compiled_grammar, tensor_library_name, custom_adapter
+        )

-    def get_cfg_logits_processor(self, grammar: str) -> "LogitsProcessor":
+    def get_cfg_logits_processor(
+        self,
+        grammar: str,
+        tensor_library_name: str = "torch",
+        custom_adapter: Optional[TensorAdapter] = None
+    ) -> "LogitsProcessor":
         """Create a logits processor from a context-free grammar.

         Parameters
         ----------
         grammar: str
             The context-free grammar to create a logits processor from.
+        tensor_library_name: str
+            The name of the tensor library to use. Can be "torch", "mlx",
+            "numpy", "jax", "tensorflow", or "custom".
+        custom_adapter: Optional[TensorAdapter]
+            Custom tensor adapter to use when tensor_library_name is "custom".

         Returns
         -------
@@ -131,4 +192,6 @@ class XGrammarBackend(BaseBackend):

         """
         compiled_grammar = self.grammar_compiler.compile_grammar(grammar)
-        return XGrammarLogitsProcessor(compiled_grammar)
+        return XGrammarLogitsProcessor(
+            compiled_grammar, tensor_library_name, custom_adapter
+        )
diff --git a/outlines/processors/base_logits_processor.py b/outlines/processors/base_logits_processor.py
index 9b4e4fe5..21229add 100644
--- a/outlines/processors/base_logits_processor.py
+++ b/outlines/processors/base_logits_processor.py
@@ -28,8 +28,9 @@ class OutlinesLogitsProcessor:
         ----------
         tensor_library_name
             The name of the library to use to manipulate tensors. Possible
-            values are "jax", "mlx", "numpy", "tensorflow" and "torch". You
-            must choose the library that your model is using.
+            values are "jax", "mlx", "numpy", "tensorflow", "torch", and "custom".
+            You must choose the library that your model is using. When using "custom",
+            the tensor_adapter should be set manually by the subclass.
         """
         # Temporary fix as torch raises a warning that can cause can an error
         # with python 3.12.
@@ -38,6 +39,11 @@ class OutlinesLogitsProcessor:

             torch._dynamo.config.suppress_errors = True

+        # Skip tensor adapter initialization for custom adapters
+        if tensor_library_name == "custom":
+            # tensor_adapter will be set by the subclass
+            return
+
         tensor_adapter_class = tensor_adapters.get(tensor_library_name)
         if tensor_adapter_class is None:
             raise NotImplementedError(
diff --git a/outlines/processors/tensor_adapters/__init__.py b/outlines/processors/tensor_adapters/__init__.py
index 8e3afe7f..2b7458af 100644
--- a/outlines/processors/tensor_adapters/__init__.py
+++ b/outlines/processors/tensor_adapters/__init__.py
@@ -2,6 +2,7 @@

 from typing import Union

+from .base import TensorAdapter
 from .jax import JAXTensorAdapter
 from .mlx import MLXTensorAdapter
 from .numpy import NumpyTensorAdapter
@@ -23,4 +24,5 @@ TensorAdapterImplementation = Union[
     NumpyTensorAdapter,
     TensorFlowTensorAdapter,
     TorchTensorAdapter,
+    TensorAdapter,
 ]

