diff --git a/src/click/core.py b/src/click/core.py
index 666ad68..45912cf 100644
--- a/src/click/core.py
+++ b/src/click/core.py
@@ -228,6 +228,9 @@ class Context:
         value is not set, it defaults to the value from the parent
         context. ``Command.show_default`` overrides this default for the
         specific command.
+    :param validate_nesting: When enabled, enforces proper context hierarchy
+        management and prevents resource leaks by validating that all child
+        contexts are properly closed before the parent context exits.
 
     .. versionchanged:: 8.2
         The ``protected_args`` attribute is deprecated and will be removed in
@@ -280,6 +283,7 @@ class Context:
         token_normalize_func: t.Callable[[str], str] | None = None,
         color: bool | None = None,
         show_default: bool | None = None,
+        validate_nesting: bool = False,
     ) -> None:
         #: the parent context or `None` if none exists.
         self.parent = parent
@@ -427,6 +431,12 @@ class Context:
         #: Show option default values when formatting help text.
         self.show_default: bool | None = show_default
 
+        #: When enabled, enforces proper context hierarchy management.
+        self.validate_nesting: bool = validate_nesting
+
+        #: Track child contexts for nesting validation.
+        self._child_contexts: set[Context] = set()
+
         self._close_callbacks: list[t.Callable[[], t.Any]] = []
         self._depth = 0
         self._parameter_source: dict[str, ParameterSource] = {}
@@ -607,10 +617,33 @@ class Context:
         :meth:`call_on_close`, and exit all context managers entered
         with :meth:`with_resource`.
         """
+        if self.validate_nesting and self._child_contexts:
+            unclosed_children = [
+                ctx
+                for ctx in self._child_contexts
+                if hasattr(ctx, "_exit_stack") and ctx._exit_stack is not None
+            ]
+            if unclosed_children:
+                child_names = [
+                    ctx.info_name or str(ctx.command.name) or "unknown"
+                    for ctx in unclosed_children
+                ]
+                raise RuntimeError(
+                    f"Context nesting validation failed: Parent context "
+                    f"'{self.info_name or self.command.name or 'unknown'}' "
+                    f"cannot be closed while child contexts are still open: "
+                    f"{', '.join(child_names)}. Please ensure all child "
+                    f"contexts are properly closed before closing the parent."
+                )
+
         self._exit_stack.close()
         # In case the context is reused, create a new exit stack.
         self._exit_stack = ExitStack()
 
+        # Remove this context from parent's child tracking
+        if self.parent and hasattr(self.parent, "_child_contexts"):
+            self.parent._child_contexts.discard(self)
+
     @property
     def command_path(self) -> str:
         """The computed command path.  This is used for the ``usage``
@@ -728,7 +761,20 @@ class Context:
 
         :meta private:
         """
-        return type(self)(command, info_name=command.name, parent=self)
+        # Inherit validate_nesting from parent if it's enabled
+        validate_nesting = getattr(self, "validate_nesting", False)
+        sub_ctx = type(self)(
+            command,
+            info_name=command.name,
+            parent=self,
+            validate_nesting=validate_nesting,
+        )
+
+        # Register child context if validation is enabled
+        if validate_nesting and hasattr(self, "_child_contexts"):
+            self._child_contexts.add(sub_ctx)
+
+        return sub_ctx
 
     @t.overload
     def invoke(
@@ -1582,9 +1628,9 @@ class Group(Command):
         func: t.Callable[..., t.Any] | None = None
 
         if args and callable(args[0]):
-            assert (
-                len(args) == 1 and not kwargs
-            ), "Use 'command(**kwargs)(callable)' to provide arguments."
+            assert len(args) == 1 and not kwargs, (
+                "Use 'command(**kwargs)(callable)' to provide arguments."
+            )
             (func,) = args
             args = ()
 
@@ -1631,9 +1677,9 @@ class Group(Command):
         func: t.Callable[..., t.Any] | None = None
 
         if args and callable(args[0]):
-            assert (
-                len(args) == 1 and not kwargs
-            ), "Use 'group(**kwargs)(callable)' to provide arguments."
+            assert len(args) == 1 and not kwargs, (
+                "Use 'group(**kwargs)(callable)' to provide arguments."
+            )
             (func,) = args
             args = ()
 
diff --git a/src/click/shell_completion.py b/src/click/shell_completion.py
index 6fd9e54..5ab0d34 100644
--- a/src/click/shell_completion.py
+++ b/src/click/shell_completion.py
@@ -544,6 +544,8 @@ def _resolve_context(
     :param args: List of complete args before the incomplete value.
     """
     ctx_args["resilient_parsing"] = True
+    # Disable nesting validation during shell completion to avoid validation errors
+    ctx_args["validate_nesting"] = False
     ctx = cli.make_context(prog_name, args.copy(), **ctx_args)
     args = ctx._protected_args + ctx.args
 
@@ -557,7 +559,13 @@ def _resolve_context(
                 if cmd is None:
                     return ctx
 
-                ctx = cmd.make_context(name, args, parent=ctx, resilient_parsing=True)
+                ctx = cmd.make_context(
+                    name,
+                    args,
+                    parent=ctx,
+                    resilient_parsing=True,
+                    validate_nesting=False,
+                )
                 args = ctx._protected_args + ctx.args
             else:
                 sub_ctx = ctx
@@ -575,6 +583,7 @@ def _resolve_context(
                         allow_extra_args=True,
                         allow_interspersed_args=False,
                         resilient_parsing=True,
+                        validate_nesting=False,
                     )
                     args = sub_ctx.args
 

