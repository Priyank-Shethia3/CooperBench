diff --git a/tests/test_shell_completion.py b/tests/test_shell_completion.py
index 3e7a2bd..c7527dc 100644
--- a/tests/test_shell_completion.py
+++ b/tests/test_shell_completion.py
@@ -414,3 +414,135 @@ def test_add_completion_class_decorator():
     # Using `add_completion_class` as a decorator adds the new shell immediately
     assert "mysh" in click.shell_completion._available_shells
     assert click.shell_completion._available_shells["mysh"] is MyshComplete
+
+
+def test_validate_nesting_disabled():
+    """Test that validate_nesting=False allows normal context usage."""
+
+    @click.group(invoke_without_command=True)
+    def cli():
+        pass
+
+    @cli.command()
+    def sub():
+        pass
+
+    # Should work normally without validation
+    ctx = cli.make_context("cli", [], validate_nesting=False)
+    sub_ctx = ctx._make_sub_context(sub)
+
+    # Close parent before child - should work fine
+    ctx.close()
+    sub_ctx.close()
+
+
+def test_validate_nesting_enabled_proper_cleanup():
+    """Test that validate_nesting=True allows proper context cleanup."""
+
+    @click.group(invoke_without_command=True)
+    def cli():
+        pass
+
+    @cli.command()
+    def sub():
+        pass
+
+    ctx = cli.make_context("cli", [], validate_nesting=True)
+    sub_ctx = ctx._make_sub_context(sub)
+
+    # Proper cleanup order - child first, then parent
+    sub_ctx.close()
+    ctx.close()
+
+
+def test_validate_nesting_multiple_children():
+    """Test validation with multiple child contexts."""
+
+    @click.group(invoke_without_command=True)
+    def cli():
+        pass
+
+    @cli.command()
+    def sub1():
+        pass
+
+    @cli.command()
+    def sub2():
+        pass
+
+    ctx = cli.make_context("cli", [], validate_nesting=True)
+    sub_ctx1 = ctx._make_sub_context(sub1)
+    sub_ctx2 = ctx._make_sub_context(sub2)
+
+    # Try to close parent while children are open
+    with pytest.raises(RuntimeError):
+        ctx.close()
+
+    # Close one child
+    sub_ctx1.close()
+
+    # Still should fail with one child open
+    with pytest.raises(RuntimeError):
+        ctx.close()
+
+    # Close second child
+    sub_ctx2.close()
+
+    # Now parent should close successfully
+    ctx.close()
+
+
+def test_validate_nesting_inheritance():
+    """Test that validate_nesting is inherited by child contexts."""
+
+    @click.group(invoke_without_command=True)
+    def cli():
+        pass
+
+    @cli.command()
+    def sub():
+        pass
+
+    @cli.command()
+    def subsub():
+        pass
+
+    # Parent with validation enabled
+    ctx = cli.make_context("cli", [], validate_nesting=True)
+    sub_ctx = ctx._make_sub_context(sub)
+
+    # Grandchild should inherit validation
+    assert sub_ctx.validate_nesting is True
+
+    subsub_ctx = sub_ctx._make_sub_context(subsub)
+    assert subsub_ctx.validate_nesting is True
+
+    # Try to close middle context while grandchild is open
+    with pytest.raises(RuntimeError):
+        sub_ctx.close()
+
+    # Clean up properly
+    subsub_ctx.close()
+    sub_ctx.close()
+    ctx.close()
+
+
+def test_validate_nesting_context_manager():
+    """Test validation with context managers."""
+
+    @click.group(invoke_without_command=True)
+    def cli():
+        pass
+
+    @cli.command()
+    def sub():
+        pass
+
+    ctx = cli.make_context("cli", [], validate_nesting=True)
+
+    # Using context manager should work properly
+    with ctx:
+        sub_ctx = ctx._make_sub_context(sub)
+        with sub_ctx:
+            pass  # Both contexts will be cleaned up properly
+
